<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
    <title>Todo list</title>

</head>
<body class="bg-fuchsia-700">

    <h1 class="text-7xl text-white">To-do list</h1>
    <h2 class="text-4xl text-white">In here, you can write and storage your tasks for your todo list</h2>

    <textarea class="text-xl" name="task" id="task" cols="80" rows="5" placeholder="Write your task here"></textarea>
    <button type="button" onclick="saveTask()" class="bg-blue-500 hover:bg-blue-700 rounded-md p-3 text-white">Save task</button>

    <br /><br />

    <div class="px-12">
        <ol id="tasklist" class="list-none text-white">
        </ol>
    </div>

    <script>
        let taskArray = [];

        retrieveTasks();

        function Task(description, status){
            this.description = description;
            this.status = status;
        }

        function storeTasks(){

            localStorage.setItem("tasks", JSON.stringify(taskArray));

        }

        function retrieveTasks(){

            let getTasks = JSON.parse(localStorage.getItem("tasks"));

            if(getTasks != null){

                taskArray = getTasks;
                changeTaskList();

            }

        }

        function changeTaskList(){

            let taskListElement = document.getElementById("tasklist");

            taskListElement.innerHTML = "";

            taskArray.map((task, index) => {

                if(task.status == "incomplete"){

                    taskListElement.innerHTML += `
                    <li id="${index}" class="w-auto bg-yellow-300 p-3 text-lg text-black flex">
                        <p class="cursor-pointer flex-auto w-64" onclick="completeTask(${index})">${index+1}. ${task.description}</p>
                        <button onclick="deleteTask(${index})">
                            <strong class="float-right text-xl align-center cursor-pointer alert-del flex-none">&times;</strong>
                        </button>
                    </li>
                    <br />`;

                }
                else{

                    taskListElement.innerHTML += `
                    <li id="${index}" class="w-auto bg-green-500 p-3 text-lg text-black flex">
                        <p class="cursor-pointer flex-auto w-64" onclick="setIncompleteTask(${index})">${index+1}. ${task.description}</p>
                    </li>
                    <br />`;

                }

            });

            storeTasks();

        }

        function saveTask() {

            let taskListElement = document.getElementById("tasklist");
            let taskTextAreaValue = document.getElementById("task").value;

            if(taskTextAreaValue != ""){

                if(taskTextAreaValue.length <= 3){

                    alert("Value must be greater than 3 characters!");

                }
                else{

                    if(taskArray.length >= 8){

                        alert("Maximum 8 items are allowed to add in the list.");

                    }
                    else{

                        taskArray.push(new Task(taskTextAreaValue, "incomplete"));

                        changeTaskList();

                    }

                }

            }
            else{

                console.log("Input text please");

            }

        }

        function deleteTask(id){

            let decision = confirm("Do you want to delete the task?");
            let taskListElement = document.getElementById("tasklist");
            
            if(decision){

                taskArray.splice(id, 1);

                changeTaskList();

            }

        }

        function completeTask(id){

            let taskListElement = document.getElementById("tasklist");

            taskArray[id].status = "complete";

            changeTaskList();

        }

        function setIncompleteTask(id){

            let taskListElement = document.getElementById("tasklist");

            taskArray[id].status = "incomplete";

            changeTaskList();

        }

    </script>

</body>
</html>